# Makefile for translation files.
# Copyright (C) 1995 Free Software Foundation, Inc.
#
# This program is free software; you can redistribute it and/or modify
# it under the terms of the GNU General Public License as published by
# the Free Software Foundation; either version 2, or (at your option)
# any later version.
#
# This program is distributed in the hope that it will be useful,
# but WITHOUT ANY WARRANTY; without even the implied warranty of
# MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
# GNU General Public License for more details.
#
# You should have received a copy of the GNU General Public License
# along with this program; if not, write to the Free Software
# Foundation, Inc., 675 Mass Ave, Cambridge, MA 02139, USA.

PACKAGE = @PACKAGE@
VERSION = @VERSION@

SHELL = /bin/sh
@SET_MAKE@

srcdir = @srcdir@
top_srcdir = @top_srcdir@
VPATH = @srcdir@

prefix = @prefix@
exec_prefix = @exec_prefix@
datadir = $(prefix)/@DATADIRNAME@
localedir = $(datadir)/locale
subdir = po

INSTALL = @INSTALL@
INSTALL_DATA = @INSTALL_DATA@

GENCAT = @GENCAT@
GMSGFMT = @GMSGFMT@ 
MSGFMT = @MSGFMT@ 
TUPDATE = tupdate
XGETTEXT = @XGETTEXT@

POFILES = de.po fr.po pt.po sv.po
MOFILES = de.gmo fr.gmo pt.gmo sv.gmo
DISTFILES = Makefile.in POTFILES $(PACKAGE).pot $(POFILES) $(MOFILES)

CATALOGS = @CATALOGS@
CATOBJEXT = @CATOBJEXT@
INSTOBJEXT = $(CATOBJEXT:.gmo=.mo)
POTFILES = @POTFILES@

.SUFFIXES:
.SUFFIXES: .po .pox .gmo .mo .msg .cat

.po.pox:
	$(MAKE) $(PACKAGE).pot
	$(TUPDATE) $(srcdir)/$(PACKAGE).pot $*.po > $*.pox

.po.mo:
	$(MSGFMT) -o $@ $<

.po.gmo:
	$(GMSGFMT) -o $@ $<
	mv $@.mo $@
	echo $@ | grep / >/dev/null || mv $@ $(srcdir)/$@

.po.msg:
	sed -f ../intl/po-to-msg.sed < $(srcdir)/$*.po > $@

.msg.cat:
	rm -f $@
	$(GENCAT) $@ $*.msg


all: $(CATALOGS)

$(PACKAGE).pot: $(POTFILES)
	cd $(top_srcdir) && \
	  $(XGETTEXT) -ppo -d$(PACKAGE) -n -k -k_ `cat po/POTFILES`
	cd $(srcdir) && \
	  if cmp -s $(PACKAGE).po $(PACKAGE).pot; then rm $(PACKAGE).po; \
	  else rm -f $(PACKAGE).pot; mv $(PACKAGE).po $(PACKAGE).pot; fi

install: install-exec install-data
install-exec:
install-data: all
	for cat in $(CATALOGS); do \
	  lang=`echo $$cat | sed 's|.*/||' | sed 's|$(CATOBJEXT)||'`; \
	  dir=$(localedir)/$$lang/LC_MESSAGES; \
	  $(top_srcdir)/mkinstalldirs $$dir; \
	  if test -f $$cat; then \
	    $(INSTALL_DATA) $$cat $$dir/$(PACKAGE)$(INSTOBJEXT); \
	  else \
	    $(INSTALL_DATA) $(srcdir)/$$cat $$dir/$(PACKAGE)$(INSTOBJEXT); \
	  fi; \
	done

uninstall:
	for cat in $(CATALOGS); do \
	  lang=`echo $$cat | sed 's,.*/,,' | sed s'$(CATOBJEXT)$$''`; \
	  rm -f $(localedir)/$$lang/LC_MESSAGES/$(PACKAGE)$(INSTOBJEXT); \
	done

TAGS:

mostlyclean:
	rm -f core core.* *.pox

clean: mostlyclean

distclean: clean
	rm -f Makefile *.mo *.msg *.cat

maintainer-clean: distclean
	@echo "This command is intended for maintainers to use;"
	@echo "it deletes files that may require special tools to rebuild."

distdir = ../$(PACKAGE)-$(VERSION)/$(subdir)
dist: $(DISTFILES)
#	for lang in $(CATALOGS:$(CATOBJEXT)=); do \
#	  mv $$lang.po $$lang.old.po; \
#	  $(TUPDATE) $(top_srcdir)/$(PACKAGE).pot $$lang.old.po > $$lang.po; \
#	  rm -f $$lang.old.po; \
#	done
	for file in $(DISTFILES); do \
	  ln $(srcdir)/$$file $(distdir) 2> /dev/null \
	    || cp -p $(srcdir)/$$file $(distdir); \
	done

Makefile: Makefile.in ../config.status
	cd .. && CONFIG_FILES=$(subdir)/$@ CONFIG_HEADERS= ./config.status

# Tell versions [3.59,3.63) of GNU make not to export all variables.
# Otherwise a system limit (for SysV at least) may be exceeded.
.NOEXPORT:
